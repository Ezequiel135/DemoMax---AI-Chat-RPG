
<app-header></app-header>

<div class="min-h-screen pt-4 pb-20 md:pb-4 px-2 md:px-6 max-w-[1800px] mx-auto flex flex-col h-full md:h-screen md:overflow-hidden page-enter">
  
  @if (novel(); as vn) {
    <!-- TOP BAR -->
    <div class="flex flex-col md:flex-row justify-between items-center bg-slate-900 border border-slate-700 rounded-2xl p-3 mb-3 shrink-0 gap-3">
       <div class="flex items-center gap-4 w-full md:w-auto px-2">
          <span class="text-xl">ðŸŽ¬</span>
          <input [(ngModel)]="vn.title" class="bg-transparent text-white font-bold text-lg focus:outline-none w-full md:w-64 placeholder-slate-600" placeholder="TÃ­tulo do Projeto">
       </div>
       <button (click)="save()" class="w-full md:w-auto px-8 py-2 bg-pink-600 hover:bg-pink-500 text-white font-bold rounded-xl shadow-lg transition-all text-sm">
          Salvar Projeto
       </button>
    </div>

    <!-- WORKSPACE -->
    <div class="flex flex-col lg:flex-row gap-3 flex-1 min-h-0 overflow-y-auto lg:overflow-hidden">
       
       <!-- 1. LEFT: SCENE LIST (Mini Interface) -->
       <div class="w-full lg:w-72 shrink-0 h-64 lg:h-full">
          <app-vn-scene-list 
             [scenes]="scenes()" 
             [selectedId]="selectedSceneId()" 
             [startId]="vn.startSceneId"
             (select)="selectedSceneId.set($event)"
             (add)="addScene()"
             (remove)="deleteScene($event)">
          </app-vn-scene-list>
       </div>

       <!-- 2. CENTER: PREVIEW (Mini Interface) -->
       <div class="flex-1 min-h-[300px] lg:min-h-0 shrink-0">
          <app-vn-stage-preview 
             [scene]="activeScene()">
          </app-vn-stage-preview>
       </div>

       <!-- 3. RIGHT: PROPERTIES (Mini Interface) -->
       <div class="w-full lg:w-80 shrink-0 h-auto lg:h-full">
          <app-vn-property-editor 
             [scene]="activeScene()"
             [allScenes]="scenes()"
             [currentStartId]="vn.startSceneId"
             (update)="triggerUpdate()"
             (setStart)="updateStartScene($event)"
             (uploadImage)="handleImageUpload($event)"
             (addChoice)="addChoice()"
             (removeChoice)="removeChoice($event)">
          </app-vn-property-editor>
       </div>

    </div>
  }
</div>
